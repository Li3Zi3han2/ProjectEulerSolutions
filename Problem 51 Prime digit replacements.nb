(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30592,        554]
NotebookOptionsPosition[     29864,        534]
NotebookOutlinePosition[     30221,        550]
CellTagsIndexPosition[     30178,        547]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
By replacing the 1st digit of the 2-digit number *3, it turns out that six of \
the nine possible values: 13, 23, 43, 53, 73, and 83, are all prime.

By replacing the 3rd and 4th digits of 56**3 with the same digit, this \
5-digit number is the first example having seven primes among the ten \
generated numbers, yielding the family: 56003, 56113, 56333, 56443, 56663, \
56773, and 56993. Consequently 56003, being the first member of this family, \
is the smallest prime with this property.

Find the smallest prime which, by replacing part of the number (not \
necessarily adjacent digits) with the same digit, is part of an eight prime \
value family.\
\>", "Text",
 CellChangeTimes->{{3.7250279304970117`*^9, 3.7250279484658413`*^9}, {
   3.725028473459318*^9, 3.7250284801961555`*^9}, {3.72502968208926*^9, 
   3.72502968558521*^9}, 3.725030013214984*^9, 3.725030112682036*^9, 
   3.725030516419236*^9, {3.725030906832958*^9, 3.7250309751815944`*^9}, {
   3.725031351755412*^9, 3.725031355963034*^9}, {3.725031551417894*^9, 
   3.7250315615031624`*^9}, {3.725031682476709*^9, 3.725031690614868*^9}, {
   3.725032882150161*^9, 3.7250328847263002`*^9}, {3.7250330661831465`*^9, 
   3.7250330809914045`*^9}, {3.7250331393795853`*^9, 3.7250331588062754`*^9}, 
   3.725033750725789*^9, {3.7250337937122555`*^9, 3.7250337943544517`*^9}, {
   3.7250753591674275`*^9, 3.725075368361727*^9}, {3.725075469968125*^9, 
   3.7250754779205737`*^9}, {3.725077414251713*^9, 3.7250774184939256`*^9}, 
   3.7250781905849066`*^9, 3.725078250934698*^9, {3.7250785804496217`*^9, 
   3.7250785849606075`*^9}, {3.7250786814976015`*^9, 3.725078722783924*^9}, {
   3.7250896583813*^9, 3.7250897076930523`*^9}, {3.7251975771591015`*^9, 
   3.7251976146389976`*^9}, 3.725197834648633*^9, {3.725197882583401*^9, 
   3.725197890482396*^9}, {3.725200737378846*^9, 3.725200748894143*^9}, {
   3.725200838018283*^9, 3.7252008475179043`*^9}, {3.7252009022043467`*^9, 
   3.725200958804222*^9}, {3.7252010377834816`*^9, 3.7252010983703394`*^9}, {
   3.725226487267912*^9, 3.7252264924837847`*^9}, {3.725226610540694*^9, 
   3.725226631455242*^9}, {3.7252280066045084`*^9, 3.7252281047807345`*^9}, {
   3.7252421517612348`*^9, 3.725242244744773*^9}, {3.7252445289405937`*^9, 
   3.7252445329209833`*^9}, {3.725244590148712*^9, 3.7252446130595245`*^9}, {
   3.725246085726813*^9, 3.7252461283107977`*^9}, {3.725247834363762*^9, 
   3.725247848864143*^9}, {3.725248574118207*^9, 3.725248579431515*^9}, {
   3.7252486126317744`*^9, 3.725248732178588*^9}, {3.7252549862858505`*^9, 
   3.7252549910284734`*^9}, {3.72525516847269*^9, 3.725255245766756*^9}, {
   3.7252552806915483`*^9, 3.725255332199624*^9}, {3.725255487019726*^9, 
   3.7252555115899963`*^9}, {3.725255970189438*^9, 3.725256121293644*^9}, {
   3.7252561530798955`*^9, 3.725256249100648*^9}, {3.7252563013076468`*^9, 
   3.7252563058150234`*^9}, {3.725256368198352*^9, 3.725256414674964*^9}, {
   3.725256993261403*^9, 3.725256993261882*^9}, {3.725275647317864*^9, 
   3.7252756508343153`*^9}, {3.725277083745734*^9, 3.7252772062398977`*^9}, {
   3.7252772427457113`*^9, 3.725277245833682*^9}, {3.725277282244652*^9, 
   3.725277290612385*^9}, {3.7252774544953423`*^9, 3.7252774544958453`*^9}, {
   3.7252776036545553`*^9, 3.725277607261885*^9}, {3.7252776729311013`*^9, 
   3.72527778301855*^9}, {3.725316436880266*^9, 3.7253164396273546`*^9}, {
   3.7253165522980995`*^9, 3.7253165640673375`*^9}, {3.725316729060251*^9, 
   3.7253167329536285`*^9}, {3.7253171732168903`*^9, 3.725317177143325*^9}, {
   3.725318396509181*^9, 3.725318461568366*^9}, {3.7253310175647607`*^9, 
   3.725331020452732*^9}, {3.7253310543876553`*^9, 3.725331089507347*^9}, {
   3.725331170882802*^9, 3.72533117255142*^9}, {3.725331672030055*^9, 
   3.7253316747245083`*^9}, {3.7253322681492767`*^9, 3.725332270772565*^9}, {
   3.7253345405393763`*^9, 3.7253345430311794`*^9}, {3.7253367999873447`*^9, 
   3.725336803150926*^9}, {3.725336853831934*^9, 3.725336870379553*^9}, {
   3.725337226431053*^9, 3.7253372289889274`*^9}, {3.725337829872861*^9, 
   3.725337832462783*^9}, {3.725337867991741*^9, 3.7253378701291485`*^9}, {
   3.7253379148244357`*^9, 3.725337916649477*^9}, {3.7253390982997127`*^9, 
   3.7253391018817472`*^9}, {3.7253391670500546`*^9, 3.725339223622574*^9}, {
   3.725416454814953*^9, 3.7254164572647085`*^9}, {3.7254185276679907`*^9, 
   3.7254185319929934`*^9}, {3.7254186980910745`*^9, 3.725418718903507*^9}, {
   3.725426792663118*^9, 3.725426795683552*^9}, {3.7254268910078335`*^9, 
   3.7254269757184043`*^9}, {3.725427176854927*^9, 3.7254271836264095`*^9}, {
   3.725428729960781*^9, 3.7254287341449966`*^9}, {3.7254290118175664`*^9, 
   3.725429031813097*^9}, {3.725429076486433*^9, 3.725429160452042*^9}, {
   3.725435160359147*^9, 3.7254351929265566`*^9}, {3.7254352339088545`*^9, 
   3.725435340691804*^9}, {3.7254355708896446`*^9, 3.7254356017761383`*^9}, {
   3.725457540791608*^9, 3.725457600556865*^9}, {3.725538037306595*^9, 
   3.725538040133868*^9}, {3.7255382234669228`*^9, 3.7255382628247857`*^9}, {
   3.725538532537199*^9, 3.7255385348605375`*^9}, {3.725538633289014*^9, 
   3.7255386377539186`*^9}, {3.7255387709053745`*^9, 3.725538774139687*^9}, {
   3.725540891595896*^9, 3.7255408949106226`*^9}, {3.725581197613962*^9, 
   3.725581200568626*^9}, {3.7255812383311033`*^9, 3.725581263456605*^9}, {
   3.7257689404400225`*^9, 
   3.725768944125373*^9}},ExpressionUUID->"8d5dc51e-a071-405d-a21a-\
94427f13d78d"],

Cell["\<\
\:901a\:8fc7\:66ff\:63622\:4f4d\:6570*3\:7684\:7b2c1\:4f4d\:6570\:ff0c\:53ef\
\:4ee5\:770b\:51fa9\:4e2a\:53ef\:80fd\:503c\:4e2d\:76846\:4e2a\:ff1a13,23,43,\
53,73\:548c83\:90fd\:662f\:7d20\:6570\:3002

\:901a\:8fc7\:7528\:76f8\:540c\:7684\:6570\:5b57\:66ff\:636256**3\:7684\:7b2c\
3,4\:4f4d\:6570\:ff0c\:8fd9\:4e2a5\:4f4d\:6570\:662f\:7b2c\:4e00\:4e2a\:5728\
10\:4e2a\:751f\:6210\:6570\:4e2d\:5177\:67097\:4e2a\:7d20\:6570\:7684\:4f8b\
\:5b50\:ff0c\:4ea7\:751f\:65cf\:ff1a56003,56113,56333,56443,56663,56773\:548c\
56993\:3002\:56e0\:6b64\:ff0c\:4f5c\:4e3a\:8fd9\:4e2a\:5bb6\:65cf\:7684\:7b2c\
\:4e00\:4e2a\:6210\:5458\:ff0c56003\:662f\:5177\:6709\:8fd9\:4e2a\:6027\:8d28\
\:7684\:6700\:5c0f\:7684\:7d20\:6570\:3002

\:6c42\:51fa\:7528\:76f8\:540c\:7684\:6570\:5b57\:66ff\:6362\:90e8\:5206\:6570\
\:4f4d\:ff08\:4e0d\:4e00\:5b9a\:662f\:76f8\:90bb\:7684\:6570\:4f4d\:ff09\:7684\
\:751f\:6210\:6570\:4e2d\:5177\:67098\:4e2a\:7d20\:6570\:5bb6\:65cf\:7684\
\:6700\:5c0f\:7684\:7d20\:6570\:3002\
\>", "Text",
 CellChangeTimes->{
  3.725027950998102*^9, {3.7250283246450253`*^9, 3.7250283558422575`*^9}, {
   3.725028500250637*^9, 3.72502860976897*^9}, {3.7250296977151575`*^9, 
   3.7250297384176817`*^9}, {3.7250298443621716`*^9, 
   3.7250298579866343`*^9}, {3.725030039339078*^9, 3.725030042920444*^9}, {
   3.725030077306404*^9, 3.7250301759143248`*^9}, 3.7250305327502375`*^9, {
   3.725030601930706*^9, 3.72503067521985*^9}, {3.7250307093224964`*^9, 
   3.7250307452423506`*^9}, {3.7250309980667725`*^9, 
   3.7250310558361435`*^9}, {3.7250311671969223`*^9, 
   3.7250311807909555`*^9}, {3.725031379066148*^9, 3.7250314021941595`*^9}, {
   3.7250317037268467`*^9, 3.7250318716400642`*^9}, 3.7250329043712225`*^9, {
   3.725032940115158*^9, 3.7250330586151795`*^9}, {3.7250330929257145`*^9, 
   3.725033130082982*^9}, {3.7250337650673532`*^9, 3.7250338370698204`*^9}, 
   3.7250753973540573`*^9, {3.7250754497311616`*^9, 3.725075501994363*^9}, {
   3.725077474208675*^9, 3.7250774946864166`*^9}, {3.725077528595456*^9, 
   3.7250776054295306`*^9}, 3.7250776439464784`*^9, {3.7250777088241644`*^9, 
   3.7250777220740485`*^9}, {3.7250782129110246`*^9, 3.7250782628758936`*^9}, 
   3.725078623271495*^9, {3.7250787566370077`*^9, 3.7250787616963863`*^9}, {
   3.7250788023403983`*^9, 3.725078812896817*^9}, {3.725078847593706*^9, 
   3.725078898199813*^9}, {3.7250789862669144`*^9, 3.725079025435282*^9}, {
   3.7250803729112215`*^9, 3.7250803833869925`*^9}, {3.7250897119929256`*^9, 
   3.7250897568096437`*^9}, {3.72519764142445*^9, 3.7251976873250837`*^9}, {
   3.7251978511327586`*^9, 3.725197995080759*^9}, 3.7252007868162484`*^9, {
   3.725201257348057*^9, 3.7252012728921013`*^9}, {3.7252013224671493`*^9, 
   3.7252014061385584`*^9}, 3.7252014487892776`*^9, 3.725226514910051*^9, {
   3.72522655172649*^9, 3.7252265988615456`*^9}, {3.7252266658019123`*^9, 
   3.7252267403636074`*^9}, {3.7252267728962317`*^9, 3.725226814620206*^9}, {
   3.725226926497161*^9, 3.725227057612776*^9}, {3.725227626495095*^9, 
   3.7252276471560698`*^9}, 3.725228019049624*^9, {3.725228120171215*^9, 
   3.7252282064414434`*^9}, 3.725242170051362*^9, {3.7252422642153482`*^9, 
   3.7252422721374626`*^9}, {3.7252423503191156`*^9, 3.7252425234380713`*^9}, 
   3.725244550998564*^9, {3.725244633693759*^9, 3.725244651626563*^9}, {
   3.725244683873289*^9, 3.725244750655381*^9}, {3.725244782538108*^9, 
   3.725244864916603*^9}, 3.7252461043908043`*^9, {3.7252461875490437`*^9, 
   3.7252462410836463`*^9}, {3.72524627890158*^9, 3.7252462878653393`*^9}, {
   3.725246325809107*^9, 3.725246378051381*^9}, {3.7252464191908007`*^9, 
   3.725246446243775*^9}, {3.7252464864418354`*^9, 3.725246491598501*^9}, {
   3.7252465224084396`*^9, 3.725246557437722*^9}, {3.725246607455763*^9, 
   3.7252466219992943`*^9}, 3.7252478506588*^9, {3.725247895926965*^9, 
   3.7252478974205728`*^9}, {3.7252480059175434`*^9, 3.725248111973029*^9}, 
   3.725248597864355*^9, {3.725248750471916*^9, 3.725248832613776*^9}, {
   3.7252488684378357`*^9, 3.725248898312883*^9}, 3.725255013188736*^9, {
   3.7252555213571625`*^9, 3.725255681700714*^9}, 3.7252563619502344`*^9, {
   3.725256433962099*^9, 3.7252565943223753`*^9}, {3.7252566265260277`*^9, 
   3.7252568563826323`*^9}, {3.725256926783057*^9, 3.7252569458087287`*^9}, {
   3.7252569901699705`*^9, 3.7252569901699705`*^9}, {3.7252581724126654`*^9, 
   3.7252582124772353`*^9}, 3.7252756797102346`*^9, {3.7252757200747643`*^9, 
   3.7252757830366054`*^9}, {3.7252758306537437`*^9, 
   3.7252758340235057`*^9}, {3.7252760470993495`*^9, 3.72527604835888*^9}, {
   3.7252768595704403`*^9, 3.725276861151313*^9}, 3.7252771238823395`*^9, {
   3.7252772215976086`*^9, 3.725277250153853*^9}, {3.7252773946472034`*^9, 
   3.725277485709404*^9}, {3.725277634050622*^9, 3.7252776530090513`*^9}, {
   3.725277733548936*^9, 3.7252778577800245`*^9}, {3.725316460001274*^9, 
   3.7253166110392017`*^9}, 3.725316763219675*^9, {3.725316994153453*^9, 
   3.7253171368820124`*^9}, {3.725317182606453*^9, 3.7253172728569736`*^9}, {
   3.725317303749717*^9, 3.7253173261669483`*^9}, {3.7253178056515446`*^9, 
   3.725317808518752*^9}, 3.7253184234324665`*^9, {3.7253184874444733`*^9, 
   3.7253185073859253`*^9}, {3.725318542499407*^9, 3.725318612024629*^9}, {
   3.7253186461520033`*^9, 3.725318706827264*^9}, {3.7253187620083313`*^9, 
   3.7253187711816483`*^9}, 3.725318820644291*^9, {3.7253310407068224`*^9, 
   3.725331050763226*^9}, {3.725331110172758*^9, 3.7253312411282063`*^9}, {
   3.725331697581786*^9, 3.7253317009397435`*^9}, {3.725331744647582*^9, 
   3.725331771220255*^9}, {3.725331805588923*^9, 3.7253318304542475`*^9}, 
   3.7253322980322294`*^9, {3.7253324468636484`*^9, 3.7253324563322997`*^9}, 
   3.725332642829089*^9, {3.7253343123657236`*^9, 3.725334416474839*^9}, {
   3.725334573806799*^9, 3.7253347044577675`*^9}, {3.7253347549856224`*^9, 
   3.7253347580780935`*^9}, 3.7253348152063484`*^9, 3.725336791413701*^9, {
   3.7253368323717794`*^9, 3.7253368422598963`*^9}, {3.7253368871824293`*^9, 
   3.7253369041194983`*^9}, {3.7253369449724607`*^9, 3.725336993586126*^9}, {
   3.7253370454664855`*^9, 3.7253372219870787`*^9}, 3.7253378407440896`*^9, {
   3.725337877403327*^9, 3.7253379308534555`*^9}, 3.725339122657111*^9, {
   3.7253392495547314`*^9, 3.7253393028957467`*^9}, 3.7254164794582653`*^9, {
   3.725416578301237*^9, 3.7254166022452345`*^9}, {3.725416652283618*^9, 
   3.725416677022488*^9}, {3.725418546970685*^9, 3.7254186876873355`*^9}, {
   3.7254187459868345`*^9, 3.725418853286748*^9}, 3.7254268328672805`*^9, {
   3.725426880297798*^9, 3.725426881882676*^9}, {3.7254271157391744`*^9, 
   3.7254271205590367`*^9}, {3.7254272029685717`*^9, 
   3.7254272723148565`*^9}, {3.725427369250471*^9, 3.725427436714831*^9}, {
   3.7254274749639854`*^9, 3.725427522285083*^9}, 3.725428946394585*^9, {
   3.725429039851154*^9, 3.725429068424348*^9}, {3.7254291097809467`*^9, 
   3.725429117000083*^9}, {3.7254291654026213`*^9, 3.7254292764907894`*^9}, {
   3.725435186116023*^9, 3.725435208521934*^9}, {3.7254353466969957`*^9, 
   3.7254354565743303`*^9}, {3.725435547153366*^9, 3.7254355988037767`*^9}, {
   3.7254576271998477`*^9, 3.725457650655244*^9}, {3.7254578600829277`*^9, 
   3.7254578876949987`*^9}, {3.725457922047659*^9, 3.725457946013631*^9}, {
   3.7255380620528765`*^9, 3.7255381021101184`*^9}, {3.725538152119523*^9, 
   3.725538220107767*^9}, {3.7255382676453047`*^9, 3.7255383228282123`*^9}, {
   3.725538546509217*^9, 3.7255386183682213`*^9}, {3.7255387864889135`*^9, 
   3.725538800800104*^9}, {3.725538837604594*^9, 3.725538870140872*^9}, {
   3.7255389046184263`*^9, 3.7255390428257904`*^9}, {3.725581218398059*^9, 
   3.7255814442735224`*^9}, {3.7257689515943975`*^9, 
   3.7257690639995337`*^9}, {3.7257691132498913`*^9, 
   3.7257693217267513`*^9}, {3.725769355924509*^9, 3.725769400422945*^9}, {
   3.7257694627386694`*^9, 
   3.7257694690197144`*^9}},ExpressionUUID->"9c8b4bdc-480f-44ee-b76f-\
e4f4d6ba60af"],

Cell[BoxData[{
 RowBox[{"\:8bbe\:662fn\:4f4d\:6570", "\:ff0c", 
  "\:66ff\:6362\:5176\:4e2d\:7684k\:4f4d", "\:ff0c", "\:66ff\:6362\:4e3at", 
  "\:ff0c", 
  "\:5269\:4f59\:4f4d\:6570\:4e4b\:548c\:9664\:4ee53\:4f59r"}], "\
\[IndentingNewLine]", GridBox[{
   {
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k", " ", "t"}], "+", "r"}], ",", "3"}], "]"}], "\[NotEqual]", 
     RowBox[{"0", "\:7684\:4e2a\:6570"}]}], 
    RowBox[{"k", "=", "1"}], 
    RowBox[{"k", "=", "2"}], 
    RowBox[{"k", "=", "3"}], 
    RowBox[{"k", "=", "4"}], 
    RowBox[{"k", "=", "5"}], 
    RowBox[{"k", "=", "6"}], 
    RowBox[{"k", "=", "7"}], 
    RowBox[{"k", "=", "8"}], 
    RowBox[{"k", "=", "9"}], 
    RowBox[{"k", "=", "10"}], "\[Ellipsis]"},
   {
    RowBox[{"r", "=", "0"}], "6", "6", "0", "6", "6", "0", "6", "6", "0", "6",
     "\[Ellipsis]"},
   {
    RowBox[{"r", "=", "1"}], "7", "7", "10", "7", "7", "10", "7", "7", "10", 
    "7", "\[Ellipsis]"},
   {
    RowBox[{"r", "=", "2"}], "7", "7", "10", "7", "7", "10", "7", "7", "10", 
    "7", "\[Ellipsis]"}
  }], "\[IndentingNewLine]", 
 RowBox[{"\:5373\:6700\:5c11\:662f4\:4f4d\:6570", "\:ff1b", 
  RowBox[{"\:662f\:7d20\:6570", 
   RowBox[{"\:ff08", 
    RowBox[{
    "\:6700\:540e\:4e00\:4f4d\:5fc5\:987b\:662f1", ",", "3", ",", "7", ",", 
     "9"}], "\:ff09"}]}], "\:ff1b", "\:9664\:53bb\:6700\:540e\:4e00\:4f4d", 
  "\:ff0c", 
  RowBox[{
  "\:5269\:4f59\:4f4d\:6570\:81f3\:5c11\:67093", " ", "i\:4e2a0\:62163", " ", 
   "i\:4e2a1\:62163", " ", "i\:4e2a2"}], "\:ff1b", "\n"}]}], "Text",
 CellChangeTimes->{
  3.725027950998102*^9, {3.7250283246450253`*^9, 3.7250283558422575`*^9}, {
   3.725028500250637*^9, 3.72502860976897*^9}, {3.7250296977151575`*^9, 
   3.7250297384176817`*^9}, {3.7250298443621716`*^9, 
   3.7250298579866343`*^9}, {3.725030039339078*^9, 3.725030042920444*^9}, {
   3.725030077306404*^9, 3.7250301759143248`*^9}, 3.7250305327502375`*^9, {
   3.725030601930706*^9, 3.72503067521985*^9}, {3.7250307093224964`*^9, 
   3.7250307452423506`*^9}, {3.7250309980667725`*^9, 
   3.7250310558361435`*^9}, {3.7250311671969223`*^9, 
   3.7250311807909555`*^9}, {3.725031379066148*^9, 3.7250314021941595`*^9}, {
   3.7250317037268467`*^9, 3.7250318716400642`*^9}, 3.7250329043712225`*^9, {
   3.725032940115158*^9, 3.7250330586151795`*^9}, {3.7250330929257145`*^9, 
   3.725033130082982*^9}, {3.7250337650673532`*^9, 3.7250338370698204`*^9}, 
   3.7250753973540573`*^9, {3.7250754497311616`*^9, 3.725075501994363*^9}, {
   3.725077474208675*^9, 3.7250774946864166`*^9}, {3.725077528595456*^9, 
   3.7250776054295306`*^9}, 3.7250776439464784`*^9, {3.7250777088241644`*^9, 
   3.7250777220740485`*^9}, {3.7250782129110246`*^9, 3.7250782628758936`*^9}, 
   3.725078623271495*^9, {3.7250787566370077`*^9, 3.7250787616963863`*^9}, {
   3.7250788023403983`*^9, 3.725078812896817*^9}, {3.725078847593706*^9, 
   3.725078898199813*^9}, {3.7250789862669144`*^9, 3.725079025435282*^9}, {
   3.7250803729112215`*^9, 3.7250803833869925`*^9}, {3.7250897119929256`*^9, 
   3.7250897568096437`*^9}, {3.72519764142445*^9, 3.7251976873250837`*^9}, {
   3.7251978511327586`*^9, 3.725197995080759*^9}, 3.7252007868162484`*^9, {
   3.725201257348057*^9, 3.7252012728921013`*^9}, {3.7252013224671493`*^9, 
   3.7252014061385584`*^9}, 3.7252014487892776`*^9, 3.725226514910051*^9, {
   3.72522655172649*^9, 3.7252265988615456`*^9}, {3.7252266658019123`*^9, 
   3.7252267403636074`*^9}, {3.7252267728962317`*^9, 3.725226814620206*^9}, {
   3.725226926497161*^9, 3.725227057612776*^9}, {3.725227626495095*^9, 
   3.7252276471560698`*^9}, 3.725228019049624*^9, {3.725228120171215*^9, 
   3.7252282064414434`*^9}, 3.725242170051362*^9, {3.7252422642153482`*^9, 
   3.7252422721374626`*^9}, {3.7252423503191156`*^9, 3.7252425234380713`*^9}, 
   3.725244550998564*^9, {3.725244633693759*^9, 3.725244651626563*^9}, {
   3.725244683873289*^9, 3.725244750655381*^9}, {3.725244782538108*^9, 
   3.725244864916603*^9}, 3.7252461043908043`*^9, {3.7252461875490437`*^9, 
   3.7252462410836463`*^9}, {3.72524627890158*^9, 3.7252462878653393`*^9}, {
   3.725246325809107*^9, 3.725246378051381*^9}, {3.7252464191908007`*^9, 
   3.725246446243775*^9}, {3.7252464864418354`*^9, 3.725246491598501*^9}, {
   3.7252465224084396`*^9, 3.725246557437722*^9}, {3.725246607455763*^9, 
   3.7252466219992943`*^9}, 3.7252478506588*^9, {3.725247895926965*^9, 
   3.7252478974205728`*^9}, {3.7252480059175434`*^9, 3.725248111973029*^9}, 
   3.725248597864355*^9, {3.725248750471916*^9, 3.725248832613776*^9}, {
   3.7252488684378357`*^9, 3.725248898312883*^9}, 3.725255013188736*^9, {
   3.7252555213571625`*^9, 3.725255681700714*^9}, 3.7252563619502344`*^9, {
   3.725256433962099*^9, 3.7252565943223753`*^9}, {3.7252566265260277`*^9, 
   3.7252568563826323`*^9}, {3.725256926783057*^9, 3.7252569458087287`*^9}, {
   3.7252569901699705`*^9, 3.7252569901699705`*^9}, {3.7252581724126654`*^9, 
   3.7252582124772353`*^9}, 3.7252756797102346`*^9, {3.7252757200747643`*^9, 
   3.7252757830366054`*^9}, {3.7252758306537437`*^9, 
   3.7252758340235057`*^9}, {3.7252760470993495`*^9, 3.72527604835888*^9}, {
   3.7252768595704403`*^9, 3.725276861151313*^9}, 3.7252771238823395`*^9, {
   3.7252772215976086`*^9, 3.725277250153853*^9}, {3.7252773946472034`*^9, 
   3.725277485709404*^9}, {3.725277634050622*^9, 3.7252776530090513`*^9}, {
   3.725277733548936*^9, 3.7252778577800245`*^9}, {3.725316460001274*^9, 
   3.7253166110392017`*^9}, 3.725316763219675*^9, {3.725316994153453*^9, 
   3.7253171368820124`*^9}, {3.725317182606453*^9, 3.7253172728569736`*^9}, {
   3.725317303749717*^9, 3.7253173261669483`*^9}, {3.7253178056515446`*^9, 
   3.725317808518752*^9}, 3.7253184234324665`*^9, {3.7253184874444733`*^9, 
   3.7253185073859253`*^9}, {3.725318542499407*^9, 3.725318612024629*^9}, {
   3.7253186461520033`*^9, 3.725318706827264*^9}, {3.7253187620083313`*^9, 
   3.7253187711816483`*^9}, 3.725318820644291*^9, {3.7253310407068224`*^9, 
   3.725331050763226*^9}, {3.725331110172758*^9, 3.7253312411282063`*^9}, {
   3.725331697581786*^9, 3.7253317009397435`*^9}, {3.725331744647582*^9, 
   3.725331771220255*^9}, {3.725331805588923*^9, 3.7253318304542475`*^9}, 
   3.7253322980322294`*^9, {3.7253324468636484`*^9, 3.7253324563322997`*^9}, 
   3.725332642829089*^9, {3.7253343123657236`*^9, 3.725334416474839*^9}, {
   3.725334573806799*^9, 3.7253347044577675`*^9}, {3.7253347549856224`*^9, 
   3.7253347580780935`*^9}, 3.7253348152063484`*^9, 3.725336791413701*^9, {
   3.7253368323717794`*^9, 3.7253368422598963`*^9}, {3.7253368871824293`*^9, 
   3.7253369041194983`*^9}, {3.7253369449724607`*^9, 3.725336993586126*^9}, {
   3.7253370454664855`*^9, 3.7253372219870787`*^9}, 3.7253378407440896`*^9, {
   3.725337877403327*^9, 3.7253379308534555`*^9}, 3.725339122657111*^9, {
   3.7253392495547314`*^9, 3.7253393028957467`*^9}, 3.7254164794582653`*^9, {
   3.725416578301237*^9, 3.7254166022452345`*^9}, {3.725416652283618*^9, 
   3.725416677022488*^9}, {3.725418546970685*^9, 3.7254186876873355`*^9}, {
   3.7254187459868345`*^9, 3.725418853286748*^9}, 3.7254268328672805`*^9, {
   3.725426880297798*^9, 3.725426881882676*^9}, {3.7254271157391744`*^9, 
   3.7254271205590367`*^9}, {3.7254272029685717`*^9, 
   3.7254272723148565`*^9}, {3.725427369250471*^9, 3.725427436714831*^9}, {
   3.7254274749639854`*^9, 3.725427522285083*^9}, 3.725428946394585*^9, {
   3.725429039851154*^9, 3.725429068424348*^9}, {3.7254291097809467`*^9, 
   3.725429117000083*^9}, {3.7254291654026213`*^9, 3.7254292764907894`*^9}, {
   3.725435186116023*^9, 3.725435208521934*^9}, {3.7254353466969957`*^9, 
   3.7254354565743303`*^9}, {3.725435547153366*^9, 3.7254355988037767`*^9}, {
   3.7254576271998477`*^9, 3.725457650655244*^9}, {3.7254578600829277`*^9, 
   3.7254578876949987`*^9}, {3.725457922047659*^9, 3.725457946013631*^9}, {
   3.7255380620528765`*^9, 3.7255381021101184`*^9}, {3.725538152119523*^9, 
   3.725538220107767*^9}, {3.7255382676453047`*^9, 3.7255383228282123`*^9}, {
   3.725538546509217*^9, 3.7255386183682213`*^9}, {3.7255387864889135`*^9, 
   3.725538800800104*^9}, {3.725538837604594*^9, 3.725538870140872*^9}, {
   3.7255389046184263`*^9, 3.7255390428257904`*^9}, {3.725581218398059*^9, 
   3.7255814442735224`*^9}, {3.7257689515943975`*^9, 
   3.7257690639995337`*^9}, {3.7257691132498913`*^9, 
   3.7257693217267513`*^9}, {3.725769355924509*^9, 3.725769400422945*^9}, {
   3.7257694627386694`*^9, 3.7257694690197144`*^9}, {3.7366828029525766`*^9, 
   3.736682819353018*^9}, {3.7366829831824284`*^9, 3.7366831616695523`*^9}, {
   3.7366832493548594`*^9, 3.736683286344083*^9}, {3.7366833688371983`*^9, 
   3.736683372525622*^9}, {3.736683482478451*^9, 3.7366835350892525`*^9}, {
   3.7366835718224964`*^9, 3.736683625749094*^9}, {3.736683668499399*^9, 
   3.7366836853837633`*^9}, {3.7366840421450434`*^9, 3.736684045308548*^9}, {
   3.736684102764578*^9, 3.7366841177172403`*^9}, {3.7367240306015053`*^9, 
   3.7367240385893826`*^9}},ExpressionUUID->"da8bdecc-e53e-40bf-b330-\
8bcd0bef1dae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Masks", "[", "n_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"3", ",", 
         RowBox[{"n", "-", "1"}], ",", "3"}], "]"}]}], "}"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}], ",", 
           RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", "k"}], ",", "1"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatchedMasks", "[", "p_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"IntegerLength", "[", "p", "]"}]}], ",", "masks"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"masks", "=", 
       RowBox[{"Masks", "[", "n", "]"}]}], ";", 
      RowBox[{"Cases", "[", 
       RowBox[{"masks", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"Or", "@@", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"IntegerDigits", "[", "p", "]"}], 
                 "\[LeftDoubleBracket]", "x", "\[RightDoubleBracket]"}], ",", 
                "#"}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "2"}], "]"}]}], "\[Equal]", 
            RowBox[{"Length", "[", "x", "]"}]}], "]"}]}]}]}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateFamilies", "[", "p_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"IntegerLength", "[", "p", "]"}]}], ",", 
       RowBox[{"matchedmasks", "=", 
        RowBox[{"MatchedMasks", "[", "p", "]"}]}], ",", "rules", ",", 
       "replaced"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"Outer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"List", "/@", "#1"}], ",", "#2"}], "]"}], "&"}], ",", 
         "matchedmasks", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "9"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"replaced", "=", 
       RowBox[{"Outer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"IntegerDigits", "[", "p", "]"}], ",", "#"}], "]"}], 
          "&"}], ",", "rules", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"FromDigits", ",", "replaced", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"IntegerLength", "[", "x", "]"}], "\[NotEqual]", "n"}]}], 
          ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EightPrimeFamilyQ", "[", "l_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Boole", "[", 
      RowBox[{"PrimeQ", "[", "l", "]"}], "]"}], "]"}], "\[Equal]", "8"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Prime", "[", "i", "]"}]}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Or", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"EightPrimeFamilyQ", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"GenerateFamilies", "[", "p", "]"}]}], ")"}]}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"Min", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"GenerateFamilies", "[", "p", "]"}], ",", 
          "EightPrimeFamilyQ"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{
      RowBox[{"PrimePi", "[", "1000", "]"}], "+", "1"}], ",", "\[Infinity]"}],
     "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.736683290166486*^9, 3.736683311019228*^9}, {
   3.736683402917876*^9, 3.7366834780631585`*^9}, {3.736683593387148*^9, 
   3.7366835947269382`*^9}, {3.7366837320604706`*^9, 
   3.7366838285134263`*^9}, {3.7366841546534715`*^9, 3.736684204158742*^9}, {
   3.7366842481798644`*^9, 3.73668424835384*^9}, {3.7366844536477757`*^9, 
   3.7366844876474648`*^9}, 3.7366845224780245`*^9, {3.7366846720636635`*^9, 
   3.7366847954630423`*^9}, {3.736684951605652*^9, 3.7366850178093147`*^9}, {
   3.7366850507891617`*^9, 3.7366851610349455`*^9}, {3.7366852471944885`*^9, 
   3.736685271937623*^9}, {3.736685306373245*^9, 3.736685309826706*^9}, {
   3.7366853649301043`*^9, 3.7366853685695314`*^9}, {3.736685497598381*^9, 
   3.73668550305853*^9}, {3.736685668308722*^9, 3.7366856973572025`*^9}, {
   3.7366861146010375`*^9, 3.73668635873491*^9}, {3.7366863958950877`*^9, 
   3.7366864169667974`*^9}, {3.7366864691846633`*^9, 3.736686516519254*^9}, {
   3.7366865702508597`*^9, 3.736686589787811*^9}, {3.736686643072487*^9, 
   3.736686703359073*^9}, {3.736686750995633*^9, 3.7366868340246644`*^9}, {
   3.7366868712158756`*^9, 3.736686905747465*^9}, {3.736686942443734*^9, 
   3.7366869664529877`*^9}, {3.736687039773532*^9, 3.7366870434969497`*^9}, {
   3.7366871042974544`*^9, 3.7366871763172064`*^9}, {3.7366872251442266`*^9, 
   3.7366874596096067`*^9}, 3.736687492743433*^9, {3.736687542842608*^9, 
   3.7366876193536587`*^9}, 3.736687664647586*^9, {3.7366880298915415`*^9, 
   3.736688118612687*^9}, 3.7367240592010937`*^9, {3.736724556102166*^9, 
   3.736724607240429*^9}, {3.7367247121039815`*^9, 3.736724751194415*^9}, {
   3.736724834500478*^9, 3.7367248922198286`*^9}, {3.7367264621183558`*^9, 
   3.7367264642261753`*^9}, {3.7367267575419292`*^9, 
   3.7367267880507193`*^9}, {3.7367271860222673`*^9, 
   3.7367271973200827`*^9}, {3.7367272277691746`*^9, 3.736727298268126*^9}, 
   3.7367273283010054`*^9, {3.7367273752857857`*^9, 3.736727395502827*^9}, 
   3.7367275783452344`*^9, 3.7367276091598015`*^9, {3.736727742003024*^9, 
   3.736727759916571*^9}, {3.736727898926838*^9, 3.7367278999695516`*^9}, {
   3.736728033291003*^9, 
   3.736728033557006*^9}},ExpressionUUID->"57c79dbd-9b41-4654-ac9f-\
a0d530013bd1"],

Cell[BoxData["121313"], "Output",
 CellChangeTimes->{
  3.736728036869167*^9},ExpressionUUID->"763174e8-dea1-4631-8efc-\
a860aa86f590"]
}, Open  ]]
},
WindowSize->{1350, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (2017\:5e7410\:67082\
\:65e5)",
StyleDefinitions->"Homework.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5471, 78, 196, "Text",ExpressionUUID->"8d5dc51e-a071-405d-a21a-94427f13d78d"],
Cell[6032, 100, 7972, 113, 150, "Text",ExpressionUUID->"9c8b4bdc-480f-44ee-b76f-e4f4d6ba60af"],
Cell[14007, 215, 9041, 144, 194, "Text",ExpressionUUID->"da8bdecc-e53e-40bf-b330-8bcd0bef1dae"],
Cell[CellGroupData[{
Cell[23073, 363, 6637, 163, 502, "Input",ExpressionUUID->"57c79dbd-9b41-4654-ac9f-a0d530013bd1"],
Cell[29713, 528, 135, 3, 37, "Output",ExpressionUUID->"763174e8-dea1-4631-8efc-a860aa86f590"]
}, Open  ]]
}
]
*)

